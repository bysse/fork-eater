NAME = fork-eater-language-server
VERSION = $(shell node -p "require('./package.json').version")

all: package

package: clean index_libs compile
	@echo "ðŸ“¦ Packaging $(NAME)@$(VERSION)..."
	@npx vsce package --out $(NAME)-$(VERSION).vsix
	@echo "âœ… Extension package created: $(NAME)-$(VERSION).vsix"

index_libs:
	@echo "ðŸ“‚ Generating system library index..."
	@node scripts/generate-libs-index.js

compile:
	@echo "ðŸ”¨ Compiling client and server..."
	@npm run compile

clean:
	@echo "ðŸ§¹ Cleaning up..."
	@rm -rf client/out server/out server/src/libs-index.json *.vsix
	@echo "âœ… Cleanup complete"

.PHONY: all package compile clean
